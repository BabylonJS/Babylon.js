# 5.0.0

## Major updates

- Added particle editor to the Inspector ([Deltakosh](https://github.com/deltakosh))
- Added sprite editor to the Inspector ([Deltakosh](https://github.com/deltakosh))
- Updated skeleton viewer in the Inspector ([Pryme8](https://github.com/Pryme8))
- Added texture inspection in the Inspector ([DarraghBurkeMS](https://github.com/DarraghBurkeMS))
- Added PBR support in the node material editor ([Popov72](https://github.com/Popov72))
- Added new node material editor modes: procedural textures, post processes, particle shaders ([Popov72](https://github.com/Popov72) and [Deltakosh](https://github.com/deltakosh))
- Added customizable frames in the node material editor ([Pamela W](https://github.com/msDestiny14))
- Added support for code templates in the playground ([sailro]( https://github.com/sailro))
- Added HDR texture filtering tools to the sandbox. [Doc](https://medium.com/@babylonjs/real-time-pbr-filtering-is-coming-to-babylon-cb0e81159d79) ([Sebavan](https://github.com/sebavan/))
- Revamped documentation ([RaananW](https://github.com/RaananW), [John King](https://github.com/BabylonJSGuide), [Patrick Ryan](https://github.com/PatrickRyanMS), [PiratJC](https://github.com/PirateJC))
- Added KTX + BasisU support ([Popov72](https://github.com/Popov72))
- Updated WebXR Support ([RaananW](https://github.com/RaananW))
- Added support for thin instances for faster mesh instances. [Doc](https://doc.babylonjs.com/how_to/how_to_use_thininstances) ([Popov72](https://github.com/Popov72))
- Added support in `ShadowGenerator` for soft transparent shadows ([Popov72](https://github.com/Popov72))
- Added PBR Next features: Reflection probes for accurate shading and Sub Surface Scattering ([CraigFeldpsar](https://github.com/craigfeldspar) and [Sebavan](https://github.com/sebavan/))
- Added support for latest glTF extensions: KHR_materials_clearcoat, KHR_materials_sheen, KHR_materials_transmission, KHR_texture_basisu ([Sebavan](https://github.com/sebavan/) and [Popov72](https://github.com/Popov72))
- Added support for 3D Commerce glTF extensions: KHR_material_variants and KHR_xmp ([Sebavan](https://github.com/sebavan/) and [Deltakosh](https://github.com/deltakosh))


## Updates

### General
- Added the `ShadowDepthWrapper` class to support accurate shadow generation for custom as well as node material shaders. [Doc](https://doc.babylonjs.com/babylon101/shadows#custom-shadow-map-shaders) ([Popov72](https://github.com/Popov72))
- Added support for postproces serialization ([Deltakosh](https://github.com/deltakosh))
- Added support for querystrings on KTX file URLs ([abogartz](https://github.com/abogartz))
- Refactored React refs from old string API to React.createRef() API ([belfortk](https://github.com/belfortk))
- Scale on one axis for `BoundingBoxGizmo` ([cedricguillemet](https://github.com/cedricguillemet))
- Camera gizmo ([cedricguillemet](https://github.com/cedricguillemet))
- Upgraded gizmo meshes ([davesauce14](https://github.com/davesauce14))
- Gizmo isHovered boolean ([cedricguillemet](https://github.com/cedricguillemet))
- Node support (Transform, Bone) for gizmos ([cedricguillemet](https://github.com/cedricguillemet))
- Simplified code contributions by fully automating the dev setup with gitpod ([nisarhassan12](https://github.com/nisarhassan12))
- Added a `CascadedShadowMap.IsSupported` method and log an error instead of throwing an exception when CSM is not supported ([Popov72](https://github.com/Popov72))
- Added initial code for DeviceInputSystem ([PolygonalSun](https://github.com/PolygonalSun))
- Added support for `material.disableColorWrite` ([Deltakosh](https://github.com/deltakosh))
- The Mesh Asset Task also accepts File as sceneInput ([RaananW](https://github.com/RaananW))
- Gizmo axis thickness ([cedricguillemet](https://github.com/cedricguillemet))
- When no submesh can be picked(pointcloud), falls back to bbox intersection ([cedricguillemet](https://github.com/cedricguillemet))
- Added support preserving vert colors for CSG objects ([PirateJC](https://github.com/PirateJC))
- Added `boundingBoxRenderer.onBeforeBoxRenderingObservable` and `boundingBoxRenderer.onAfterBoxRenderingObservable` ([Deltakosh](https://github.com/deltakosh))
- Better plane handling for PointerDragBehavior when camera direction colinear to axis ([cedricguillemet](https://github.com/cedricguillemet))
- Added initial code for user facing DeviceSourceManager ([PolygonalSun](https://github.com/PolygonalSun))
- Added a Simple and advanced timer, based on observables ([RaananW](https://github.com/RaananW))
- Don't log a message in `CustomProceduralTexture` if the `texturePath` is not a JSON path ([Popov72](https://github.com/Popov72))
- Added an alternate option to the mesh edge renderer to generate edges faster / more accurately for unusual geometries (like the ones generated by CSG) ([Popov72](https://github.com/Popov72))
- Added an option when creating the engine to switch matrix computation to 64 bits ([Popov72](https://github.com/Popov72))
- Added support for the alpha component to the SSR post-process ([Popov72](https://github.com/Popov72))
- Force compute world matrix of the newly-attached mesh of a ray helper ([RaananW](https://github.com/RaananW))
- Allow 180 monoscopic videos on top of the video dome ([#8575](https://github.com/BabylonJS/Babylon.js/issues/8575)) ([RaananW](https://github.com/RaananW))
- Added `AssetContainerTask` support to `AssetsManager` class ([MackeyK24](https://github.com/MackeyK24))
- Added `fixedDragMeshBoundsSize` for boundingbox gizmo to size anchors from bounds size ([cedricguillemet](https://github.com/cedricguillemet))
- Changed DeviceSourceManager getInput contract to no longer return nullable values ([Drigax](https://github.com/drigax))
- Photo Dome and Video Dome now use the same abstract class and support the same parameters ([#8771](https://github.com/BabylonJS/Babylon.js/issues/8771)) ([RaananW](https://github.com/RaananW))
- Added `getTransformNodesByTags` support to `Scene` class ([MackeyK24](https://github.com/MackeyK24))
- Added support for multi-pointer mesh selection and pointer over/out triggers ([#8820](https://github.com/BabylonJS/Babylon.js/issues/8820)) ([RaananW](https://github.com/RaananW))
- Changed DeviceSourceManager getInput contract to no longer return nullable values for reals this time. Also added proper cleanup for DeviceSourceManager observables ([Drigax](https://github.com/drigax))
- Default Loading screen supports any image size and ratio ([#8845](https://github.com/BabylonJS/Babylon.js/issues/8845)) ([RaananW](https://github.com/RaananW))
- Added optional success and error callbacks for freezeActiveMeshes ([RaananW](https://github.com/RaananW))
- Allow cross-eye mode in photo and video dome ([#8897](https://github.com/BabylonJS/Babylon.js/issues/8897)) ([RaananW](https://github.com/RaananW))
- Added noMipMap option to the photo dome construction process ([#8972](https://github.com/BabylonJS/Babylon.js/issues/8972)) ([RaananW](https://github.com/RaananW))
- Added a `disableBoundingBoxesFromEffectLayer` property to the `EffectLayer` class to render the bounding boxes unaffected by the effect ([Popov72](https://github.com/Popov72))
- Removed all references to HTML element from cameras' attach and detach control functions ([RaananW](https://github.com/RaananW))
- Added `boundingBoxRenderer.onResourcesReadyObservable` ([aWeirdo](https://github.com/aWeirdo))
- Added `copyTools.GenerateBase64StringFromTexture` ([aWeirdo](https://github.com/aWeirdo))
- Updated `axisScaleGizmo` to follow pointer on drag ([aWeirdo](https://github.com/aWeirdo))
- Added manual input for sliders on NME and inspector ([msDestiny14](https://github.com/msDestiny14))

### Engine

- Improved world matrix caching engine by using dirty mechanism on vector3 and quaternion ([Deltakosh](https://github.com/deltakosh))
- Allow logging of shader code when a compilation error occurs ([Popov72](https://github.com/Popov72))
- Added back support for selecting textures based on engine capabilities ([bghgary](https://github.com/bghgary))
- Fixed Draco decoder when running on IE11 ([bghgary](https://github.com/bghgary))
- Change default camera calculations to only include visible and enabled meshes ([bghgary](https://github.com/bghgary))
- Optimized frozen instances ([Deltakosh](https://github.com/deltakosh))
- Added support for detail maps in both the standard and PBR materials ([Popov72](https://github.com/Popov72))
- Added abstractMesh method to get all particle systems that use the mesh as an emitter ([PirateJC](https://github.com/PirateJC))
- Added customization options to VirtualJoystick ([#7398](https://github.com/BabylonJS/Babylon.js/issues/7398)) ([Rockwell15](https://github.com/Rockwell15))
- Handle meshes with LODs in render target textures (meaning in glow/highlight layers, shadow generators, depth renderer, etc) ([Popov72](https://github.com/Popov72))
- Added `Geometry.clone` to let the user make a variation on a Geometry without duplicating all buffer memory ([breakin](https://github.com/breakin))
- Added `Mesh.cloneGeometry` that makes it possible to share geometry on multiple meshes in a way that is compatible with instancing ([breakin](https://github.com/breakin))

### NME

- Frames are now resizable from the corners ([belfortk](https://github.com/belfortk))
- Can now rename and re-order frame inputs and outputs ([belfortk](https://github.com/belfortk))
- Can now edit Node port names ([belfortk](https://github.com/belfortk))
- Updated which node ports are shown on frames by default so that only node ports connected to outside nodes are by default exposed on the frame ([belfortk](https://github.com/belfortk))
- Added a modulo block ([ageneau](https://github.com/ageneau))
- Fix bug where frame port labels would be the names of incorrect nodes ([belfortk](https://github.com/belfortk))
- Fix bug where long comments on collapsed frames broke port alignment ([belfortk](https://github.com/belfortk))
- Add the `FragCoord` and `ScreenSize` blocks ([Popov72](https://github.com/Popov72))
- Particle systems: add the `ParticlePositionWorld` block ([Popov72](https://github.com/Popov72))
- Add isExposedOnFrame property to connection points ([belfortk](https://github.com/belfortk))
- Add support for exporting frames ([belfortk](https://github.com/belfortk))
- Add support for importing frames and their nodes (unconnected) and exposed frame ports ([belfortk](https://github.com/belfortk))
- Add the `rgba` and `a` outputs to the `ReflectionTexture` block ([Popov72](https://github.com/Popov72))
- Add custom frames to be uploaded into NME for reuse ([msDestiny14](https://github.com/msDestiny14))
- Node ports are now serialized for custom frames ([msDestiny14](https://github.com/msDestiny14))
- Deleting a collapsed frame will delete all nodes inside it ([msDestiny14](https://github.com/msDestiny14))

### Inspector

- Added support for follow cameras ([Deltakosh](https://github.com/deltakosh))
- New delta tool used to apply delta changes to a scene ([Deltakosh](https://github.com/deltakosh))
- Handle PBR colors as colors in linear space ([Popov72](https://github.com/Popov72))
- Allow removing textures ([Popov72](https://github.com/Popov72))
- Edit all textures (anisotropic, clear coat, sheen, ...) for the PBR materials ([Popov72](https://github.com/Popov72))
- Added right click options to create PBR and Standard Materials ([Deltakosh](https://github.com/deltakosh))
- Added support for recording GIF ([Deltakosh](https://github.com/deltakosh))
- Popup Window available (To be used in Curve Editor) ([pixelspace](https://github.com/devpixelspace))
- Added support to update inspector when switching to a new scene ([belfortk](https://github.com/belfortk))
- Hex Component for Hex inputs on layer masks. ([msDestiny14](https://github.com/msDestiny14))
- View & edit textures in pop out inspector using tools such as brush and floodfill. Supports region selection, individual channel editing, mipmap previews, and resizing. ([DarraghBurkeMS](https://github.com/DarraghBurkeMS))
- Added mesh debug tools to display bone influence weights and bone indices maps. ([Pryme8](https://github.com/Pryme8))
- Added more functionality and options to the skeleton debug panel. ([Pryme8](https://github.com/Pryme8))
- Along with bone index it is now possible to select a bone using its name when viewing bone weights ([#9117](https://github.com/BabylonJS/Babylon.js/issues/9117)) ([RaananW](https://github.com/RaananW))
- Gradient nodes from NME can now be set to be visible in the inspector ([msDestiny14](https://github.com/msDestiny14))

- Added static CenterToRef for vectors 2/3/4  ([aWeirdo](https://github.com/aWeirdo))
- Added ability to view images (ktx2, png, jpg) to the sandbox. ([bghgary](https://github.com/bghgary))
- Added support for infinite perspective cameras ([Deltakosh](https://github.com/deltakosh))

### Loaders

- Added support for EXT_meshopt_compression for glTF loader. ([zeux](https://github.com/zeux))
- Increased KHR_materials_transmission render target texture default size. ([Drigax](https://github.com/drigax))
- Changed glTF loader to remove empty animation groups if there are no animation channels loaded with the given options. ([bghgary](https://github.com/bghgary))

### Navigation

- Added support for thin instances in navigation mesh creation ([CedricGuillemet](https://github.com/CedricGuillemet))

### Materials

- Added an `OcclusionMaterial` to simplify depth-only rendering of geometry ([rgerd](https://github.com/rgerd))

### Inspector

- Added support for sounds in the inspector ([Deltakosh](https://github.com/deltakosh))

### NME

- Added ability to make input node's properties visible in the properties of a custom frame ([msDestiny14](https://github.com/msDestiny14))

### GUI

- Added a `FocusableButton` gui control to simplify creating menus with keyboard navigation ([Flux159](https://github.com/Flux159))
- Added `focus()` and `blur()` functions for controls that implement `IFocusableControl` ([Flux159](https://github.com/Flux159))
- Added `ToggleButton` GUI control ([kintz09](https://github.com/kintz09))
- Added shorthand methods which set all padding values at once, named `setPadding` and `setPaddingInPixels`, to the control class  ([kintz09](https://github.com/kintz09))

### WebXR

- A browser error preventing the emulator to render scene is now correctly dealt with ([RaananW](https://github.com/RaananW))
- Added a way to extend the XRSessionInit Object from inside of a feature ([RaananW](https://github.com/RaananW))
- Added image tracking feature ([RaananW](https://github.com/RaananW))

## Bugs

- Fix issue with the Promise polyfill where a return value was expected from resolve() ([Deltakosh](https://github.com/deltakosh))
- Fix ArcRotateCamera panning with axis decomposition ([CedricGuillemet](https://github.com/CedricGuillemet))
- Fix an issue with keyboard control (re)attachment. ([#9411](https://github.com/BabylonJS/Babylon.js/issues/9411)) ([RaananW](https://github.com/RaananW))
- Fix issue where PBRSpecularGlossiness materials were excluded from export [#9423](https://github.com/BabylonJS/Babylon.js/issues/9423)([Drigax](https://github.com/drigax))
- Fix issue when scaling is reapplied with BoundingBoxGizmo and GizmoManager ([CedricGuillemet](https://github.com/CedricGuillemet))
- Fix direct loading of a glTF string that has base64-encoded URI. ([bghgary](https://github.com/bghgary))
- Fix crash of some node materials using instances on iOS ([Popov72](https://github.com/Popov72))
- Fix the code generated for the NME gradient block ([Popov72](https://github.com/Popov72))
- Fix ssao2RenderingPipeline for orthographic cameras ([Kesshi](https://github.com/Kesshi))
- Fix mipmaps creation in the KTX2 decoder for non square textures ([Popov72](https://github.com/Popov72))
- Fix detail map not working in WebGL1 ([Popov72](https://github.com/Popov72))

## Breaking changes

- [List of breaking changes introduced by ou compatibility with WebGPU](https://doc.babylonjs.com/advanced_topics/webGPU/webGPUBreakingChanges)
    - [ReadPixels and ProceduralTexture.getContent are now async](https://doc.babylonjs.com/advanced_topics/webGPU/webGPUBreakingChanges#readpixels-is-now-asynchronous)
    - [Shader support differences](https://doc.babylonjs.com/advanced_topics/webGPU/webGPUBreakingChanges#shader-code-differences)
- Use both `mesh.visibility` and `material.alpha` values to compute the global alpha value used by the soft transparent shadow rendering code. Formerly was only using `mesh.visibility` ([Popov72](https://github.com/Popov72))
- Depth renderer: don't render mesh if `infiniteDistance = true` or if `material.disableDepthWrite = true` ([Popov72](https://github.com/Popov72))
