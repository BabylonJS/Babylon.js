var globalObject="undefined"!=typeof global?global:"undefined"!=typeof window?window:this,babylonDependency=globalObject&&globalObject.BABYLON||BABYLON||"undefined"!=typeof require&&require("babylonjs"),BABYLON=babylonDependency,__decorate=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},__extends=this&&this.__extends||(function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}})(),BABYLON;!(function(e){var t=(function(){function t(){}return t.OBJ=function(t,r,i,n){var s=[],a=1;r&&(i||(i="mat"),s.push("mtllib "+i+".mtl"));for(var o=0;o<t.length;o++){s.push("g object"+o),s.push("o object_"+o);var f=null;if(n){var u=e.Matrix.Translation(t[o].position.x,t[o].position.y,t[o].position.z);f=e.Matrix.Translation(-t[o].position.x,-t[o].position.y,-t[o].position.z),t[o].bakeTransformIntoVertices(u)}if(r){var c=t[o].material;c&&s.push("usemtl "+c.id)}var l=t[o].geometry;if(l){var d=l.getVerticesData("position"),p=l.getVerticesData("normal"),v=l.getVerticesData("uv"),h=l.getIndices(),x=0;if(d&&p&&v&&h){for(var V=0;V<d.length;V+=3)s.push("v "+d[V]+" "+d[V+1]+" "+d[V+2]),x++;for(V=0;V<p.length;V+=3)s.push("vn "+p[V]+" "+p[V+1]+" "+p[V+2]);for(V=0;V<v.length;V+=2)s.push("vt "+v[V]+" "+v[V+1]);for(V=0;V<h.length;V+=3)s.push("f "+(h[V+2]+a)+"/"+(h[V+2]+a)+"/"+(h[V+2]+a)+" "+(h[V+1]+a)+"/"+(h[V+1]+a)+"/"+(h[V+1]+a)+" "+(h[V]+a)+"/"+(h[V]+a)+"/"+(h[V]+a));n&&f&&t[o].bakeTransformIntoVertices(f),a+=x}}}return s.join("\n")},t.MTL=function(e){var t=[],r=e.material;t.push("newmtl mat1"),t.push("  Ns "+r.specularPower.toFixed(4)),t.push("  Ni 1.5000"),t.push("  d "+r.alpha.toFixed(4)),t.push("  Tr 0.0000"),t.push("  Tf 1.0000 1.0000 1.0000"),t.push("  illum 2"),t.push("  Ka "+r.ambientColor.r.toFixed(4)+" "+r.ambientColor.g.toFixed(4)+" "+r.ambientColor.b.toFixed(4)),t.push("  Kd "+r.diffuseColor.r.toFixed(4)+" "+r.diffuseColor.g.toFixed(4)+" "+r.diffuseColor.b.toFixed(4)),t.push("  Ks "+r.specularColor.r.toFixed(4)+" "+r.specularColor.g.toFixed(4)+" "+r.specularColor.b.toFixed(4)),t.push("  Ke "+r.emissiveColor.r.toFixed(4)+" "+r.emissiveColor.g.toFixed(4)+" "+r.emissiveColor.b.toFixed(4));return r.ambientTexture&&t.push("  map_Ka "+r.ambientTexture.name),r.diffuseTexture&&t.push("  map_Kd "+r.diffuseTexture.name),r.specularTexture&&t.push("  map_Ks "+r.specularTexture.name),r.bumpTexture&&t.push("  map_bump -imfchan z "+r.bumpTexture.name),r.opacityTexture&&t.push("  map_d "+r.opacityTexture.name),t.join("\n")},t})();e.OBJExport=t})(BABYLON||(BABYLON={}));var BABYLON;!(function(e){var t=(function(){function t(){}return t.GLTF=function(t,r,i){function n(e,t,r){var i={buffer:e,byteLength:r};return t>0&&(i.byteOffset=t),i}function s(e,t,r,i,n,s,a){var o={name:t,bufferView:e,componentType:i,count:n,type:r};return s&&(o.min=s),a&&(o.max=a),o}function a(e,t,r,i,n){var s=[1/0,1/0,1/0],a=[-1/0,-1/0,-1/0],o=t+r;if(r>0)for(var f=t;f<o;++f)for(var u=n*f,c=0;c<n;++c)e[u]<s[c]&&(s[c]=e[u]),e[u]>a[c]&&(a[c]=e[u]),++u;return{min:s,max:a}}function o(t,r,i,n,s,a,o){var f=s,u=r.verticesStart+r.verticesCount,c=0;switch(t){case e.VertexBuffer.PositionKind:case e.VertexBuffer.NormalKind:for(var l=r.verticesStart;l<u;++l){var d=l*n;a.setFloat32(f,i[d],!0),f+=4,a.setFloat32(f,i[d+1],!0),f+=4,o?a.setFloat32(f,i[d+2],!0):a.setFloat32(f,-i[d+2],!0),f+=4}c=12*r.verticesCount;break;case e.VertexBuffer.TangentKind:for(var l=r.indexStart;l<u;++l){var d=l*n;a.setFloat32(f,i[d],!0),f+=4,a.setFloat32(f,i[d+1],!0),f+=4,o?a.setFloat32(f,i[d+2],!0):a.setFloat32(f,-i[d+2],!0),f+=4,a.setFloat32(f,i[d+3],!0),f+=4}c=16*r.verticesCount;break;case e.VertexBuffer.ColorKind:for(var l=r.verticesStart;l<u;++l){var d=l*n;a.setFloat32(f,i[d],!0),f+=4,a.setFloat32(f,i[d+1],!0),f+=4,a.setFloat32(f,i[d+2],!0),f+=4,a.setFloat32(f,i[d+3],!0),f+=4}c=16*r.verticesCount;break;case e.VertexBuffer.UVKind:case e.VertexBuffer.UV2Kind:for(var l=r.verticesStart;l<u;++l){var d=l*n;a.setFloat32(f,i[d],!0),f+=4,a.setFloat32(f,i[d+1],!0),f+=4}c=8*r.verticesCount;break;default:throw new Error("Unsupported vertex buffer type: "+t)}return c}function f(r,i,f){for(var u={nodes:new Array},c=0;c<t.length;++c){var l={mesh:-1},d=t[c],p=d.getScene().useRightHandedSystem;0===d.position.x&&0===d.position.y&&0===d.position.z||(l.translation=p?d.position.asArray():[d.position.x,d.position.y,-d.position.z]),1===d.scaling.x&&1===d.scaling.y&&1===d.scaling.z||(l.scale=p?d.scaling.asArray():[d.scaling.x,d.scaling.y,-d.scaling.z]);var v=e.Quaternion.RotationYawPitchRoll(d.rotation.y,d.rotation.x,d.rotation.z);d.rotationQuaternion&&(v=v.multiply(d.rotationQuaternion)),0===v.x&&0===v.y&&0===v.z&&1===v.w||(l.rotation=p?v.asArray():[-v.x,-v.y,v.z,v.w]);var h=void 0,x=void 0,V=void 0,g=void 0,b=void 0,m=void 0,B=void 0,y=void 0,w=void 0,C=void 0,A=void 0,K=void 0,O=void 0,T=void 0,F=void 0,D=void 0,S=void 0,N=void 0,P=void 0;d.isVerticesDataPresent(e.VertexBuffer.PositionKind)&&(h=d.getVertexBuffer(e.VertexBuffer.PositionKind),x=h.getData(),V=h.getOffset(),g=h.getStrideSize()),d.isVerticesDataPresent(e.VertexBuffer.NormalKind)&&(b=d.getVertexBuffer(e.VertexBuffer.NormalKind),m=b.getData(),B=b.getStrideSize()),d.isVerticesDataPresent(e.VertexBuffer.TangentKind)&&(y=d.getVertexBuffer(e.VertexBuffer.TangentKind),w=y.getData(),C=y.getStrideSize()),d.isVerticesDataPresent(e.VertexBuffer.ColorKind)&&(A=d.getVertexBuffer(e.VertexBuffer.ColorKind),K=A.getData(),O=A.getStrideSize()),d.isVerticesDataPresent(e.VertexBuffer.UVKind)&&(T=d.getVertexBuffer(e.VertexBuffer.UVKind),F=T.getData(),D=T.getStrideSize()),d.isVerticesDataPresent(e.VertexBuffer.UV2Kind)&&(S=d.getVertexBuffer(e.VertexBuffer.UV2Kind),N=S.getData(),P=S.getStrideSize());var _={primitives:new Array};_.primitives=[],d.name&&(_.name=d.name);for(var U=0;U<d.subMeshes.length;++U){var L=d.subMeshes[U],z={attributes:{}};if(d.isVerticesDataPresent(e.VertexBuffer.PositionKind))if(f)i+=o(e.VertexBuffer.PositionKind,L,x,g,i,f,p);else{var j=12*L.verticesCount,Y=n(0,i,j);i+=j,r.bufferViews.push(Y);var E=a(x,L.verticesStart,L.verticesCount,V,g),R=s(r.bufferViews.length-1,"Position","VEC3",5126,L.verticesCount,E.min,E.max);r.accessors.push(R),z.attributes.POSITION=r.accessors.length-1}if(d.isVerticesDataPresent(e.VertexBuffer.NormalKind))if(f)i+=o(e.VertexBuffer.NormalKind,L,m,B,i,f,p);else{var j=12*L.verticesCount,Y=n(0,i,j);i+=j,r.bufferViews.push(Y);var R=s(r.bufferViews.length-1,"Normal","VEC3",5126,L.verticesCount);r.accessors.push(R),z.attributes.NORMAL=r.accessors.length-1}if(d.isVerticesDataPresent(e.VertexBuffer.TangentKind))if(f)i+=o(e.VertexBuffer.TangentKind,L,w,C,i,f,p);else{var j=16*L.verticesCount,Y=n(0,i,j);i+=j,r.bufferViews.push(Y);var R=s(r.bufferViews.length-1,"Tangent","VEC4",5126,L.verticesCount);r.accessors.push(R),z.attributes.TANGENT=r.accessors.length-1}if(d.isVerticesDataPresent(e.VertexBuffer.ColorKind))if(f)i+=o(e.VertexBuffer.ColorKind,L,K,O,i,f,p);else{var j=16*L.verticesCount,Y=n(0,i,j);i+=j,r.bufferViews.push(Y);var R=s(r.bufferViews.length-1,"Color","VEC4",5126,L.verticesCount);r.accessors.push(R),z.attributes.COLOR_0=r.accessors.length-1}if(d.isVerticesDataPresent(e.VertexBuffer.UVKind))if(f)i+=o(e.VertexBuffer.UVKind,L,F,D,i,f,p);else{var j=8*L.verticesCount,Y=n(0,i,j);i+=j,r.bufferViews.push(Y);var R=s(r.bufferViews.length-1,"Texture Coords","VEC2",5126,L.verticesCount);r.accessors.push(R),z.attributes.TEXCOORD_0=r.accessors.length-1}if(d.isVerticesDataPresent(e.VertexBuffer.UV2Kind))if(f)i+=o(e.VertexBuffer.UV2Kind,L,N,P,i,f,p);else{var j=8*L.verticesCount,Y=n(0,i,j);i+=j,r.bufferViews.push(Y);var R=s(r.bufferViews.length-1,"Texture Coords","VEC2",5126,L.verticesCount);r.accessors.push(R),z.attributes.TEXCOORD_1=r.accessors.length-1}if(d.getTotalIndices()>0)if(f){for(var I=d.getIndices(),k=L.indexStart,J=L.indexCount+k,M=i,G=k;G<J;G+=3)f.setUint32(M,I[G],!0),M+=4,f.setUint32(M,I[G+1],!0),M+=4,f.setUint32(M,I[G+2],!0),M+=4;var j=4*L.indexCount;i+=j}else{var Q=L.indexCount,j=4*Q,Y=n(0,i,j);i+=j,r.bufferViews.push(Y);var R=s(r.bufferViews.length-1,"Indices","SCALAR",5125,Q);r.accessors.push(R),z.indices=r.accessors.length-1}d.material&&(r.materials||(r.materials=new Array),z.material=r.materials.length-1),_.primitives.push(z)}r.meshes.push(_),l.mesh=r.meshes.length-1,d.name&&(l.name=d.name),r.nodes.push(l),u.nodes.push(r.nodes.length-1)}return r.scenes.push(u),i}var u,c,l=r.replace(/\.[^\/.]+$/,""),d={buffers:new Array,bufferViews:new Array,asset:{generator:"BabylonJS",version:"2.0"},meshes:new Array,scenes:new Array,nodes:new Array,accessors:new Array},p=0;p=f(d,p,null);var v={byteLength:p};i||(v.uri=l+".bin"),d.buffers.push(v);var h=JSON.stringify(d,null,2);if(u=new ArrayBuffer(p),c=new DataView(u),p=0,f(d,p,c),i){return (function(e,t,r){var i=r+".glb",n=e.length,s=n%4,a=t.byteLength%4,o=0===s?s:4-s,f=0===a?a:4-a,u=28+n+o+t.byteLength+f,c=new ArrayBuffer(12),l=new DataView(c);l.setUint32(0,1179937895,!0),l.setUint32(4,2,!0),l.setUint32(8,u,!0);var d=new ArrayBuffer(8+n+o),p=new DataView(d);p.setUint32(0,n+o,!0),p.setUint32(4,1313821514,!0);for(var v=new Uint8Array(d,8),h=0;h<n;++h)v[h]=e.charCodeAt(h);for(var x=new Uint8Array(d,8+n),h=0;h<o;++h)x[h]=32;var V=new ArrayBuffer(8),g=new DataView(V);g.setUint32(0,t.byteLength,!0),g.setUint32(4,5130562,!0);for(var b=new ArrayBuffer(f),m=new Uint8Array(b),h=0;h<f;++h)m[h]=0;var B=new Blob([c,d,V,t,b],{type:"application/octet-stream"});return y={},y[i]=B,y;var y})(h,u,l)}var x=l+".gltf",V=l+".bin",g=new Blob([u],{type:"application/octet-stream"});return b={},b[x]=h,b[V]=g,b;var b},t})();e.GLTFExport=t})(BABYLON||(BABYLON={})),(function(e,t){var r=t();e&&e.BABYLON||("object"==typeof exports&&"object"==typeof module?module.exports=r:"function"==typeof define&&define.amd?define(["BJSSerializers"],t):"object"==typeof exports?exports.BJSSerializers=r:e.BABYLON=r)})(this,(function(){return BABYLON}));